---
title: "Integration with ClinVar"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Issues & Solutions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>"
)
```

Original version: 1 May, 2024

```{r setup, message = FALSE}
library(AlphaMissenseR)
```

# Introduction 

[ClinVar][cv_link] is a freely available, public archive of human genetic 
variants that provides clinical classifications for whether a variant is likely 
benign or pathogenic. The AlphaMissense [publication][Science] uses the ClinVar 
data to evaluate and calibrate the predictions generated by their model. A table
containing ClinVar information for 82872 variants across 7951 proteins was 
derived from the supplemental table of the AlphaMissense paper is made available 
through this package for benchmarking and visualization purposes.

[cv_link]: https://www.ncbi.nlm.nih.gov/clinvar/
[Science]: https://www.science.org/doi/epdf/10.1126/science.adg7492


# Access ClinVar classifications with AlphaMissense predictions

The ClinVar table can be accessed using `data("clinvar_data")`.

```{r download_cv}
data("clinvar_data")
```

The ClinVar data.frame is now available for exploration or parsing. 

# Compare ClinVar and AlphaMissense 

This section uses the `plot_clinvar()` function to generate scatterplots useful 
for benchmarking and comparing ClinVar classification with AlphaMissense 
predictions. By default, the function takes one UniProt accession identifier and 
derives AlphaMissense scores from `am_data("aa_substitution")` and ClinVar 
classifications from the data.frame previously obtained. Alternatively, it is 
possible to provide a custom AlphaMissense or ClinVar table for the function. 
See function details for more information. 

```{r}
plot_clinvar(uniprotId = "P37023") 
```

We returned a `ggplot` object which overlays ClinVar classifications onto 
AlphaMissense predicted scores. Blue, gray, and red colors represent 
pathogenicity classifications for "likely benign", "ambiguous", or "likely 
pathogenic", respectively. Large, bolded points are ClinVar variants colored 
according to their clinical classification, while smaller points in the 
background are AlphaMissense predictions.

We can note a discrepancy between the clinically-validated annotations and the
AlphaMissense predictions around position 50. AlphaMissense seems to predict 
several variants in that region as likely benign, while ClinVar identifies them 
as pathogenic. 

Because the ClinVar dataset is not exhaustive (not all proteins have been 
clinically-assess), there may be proteins where information is not available. 
```{r}
plot_clinvar(uniprotId = "P0DP23")
```
In this case, the function will provide an error.
